##### Shell版本：
```
#!/bin/bash
#

declare -i ToParty=1
declare -i agentid=1000002
declare -i safe=0
content=$@
ToUser=User       # 企业微信通讯录中的有效用户
msgtype=text
CropID=xxxxxxxxxxxxxxxxxx  # ID
Secret=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx # 相应的密钥
ToKenURL=https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=${CropID}\&corpsecret=${Secret}
ToKen=`curl -s -G ${ToKenURL} | awk -F"," '{print $3}' | awk -F":" 'gsub(/"/,"",$2){print $2}'`
SendURL=https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=${ToKen}

output() { 
cat <<EOF
{
   "touser": "$ToUser",
   "toparty": "$ToParty",
   "msgtype": "text",
   "agentid": $agentid,
   "text": {
       "content": "$content"
   },
   "safe":0
}
EOF
}

/usr/bin/curl --data-ascii "$(output $content)" $SendURL
```

##### Python3版本：
* 注：此脚本发送的是卡片信息
```
#!/usr/bin/python3
#
import requests
import json

Touser = 'User'
Msgtype = 'textcard'
Agentid = AGENTID       
Toparty = TOPARTY
Tokenurl = 'https://qyapi.weixin.qq.com/cgi-bin/gettoken'
Args = { 'corpid': 'xxxxxxxxxxxxxxxxxx', 'corpsecret': 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' }    

r = requests.get(Tokenurl, params=Args)
if r.json['errcode'] == 0:
    token = r.json()['access_token']
    sendurl = 'https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=' + token
else:
    print("get access token failed.")
    exit(127)

messages = ('''{
    "touser": "%s",
    "toparty": "%s",
    "msgtype": "%s",
    "agentid": "%s",
    "textcard": {
        "title": "卡片信息title",
        "description": "<div class=\\"gray\\">信息第一行，自定义，一般为时间\\n</div><div class=\\"normal\\">信息第二行</div><div class=\\"highlight\\">第三行</div>",
        "url": "有效的URL"
    },
}''' % (Touser, Toparty, Msgtype, Agentid))

messages = messages.encode('utf-8')
p = requests.post(sendurl, data=messages)
```
